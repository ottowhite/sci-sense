<!-- Allows the page to override blocks defined in the logged_in page -->
{% extends "main_app/logged_in.html" %}

{% block stylesheets %}
    {{ block.super }}
    <style id="quiz-css">
        /* Question context CSS */
        #content {
            display: grid;

            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(4, 1fr);
        }

        #context {
            grid-column: 1/5;
        }

        #context > p {
            text-align: center;
        }

        /* Question boxes CSS */
        .question-box {
            display: grid;
            margin: 0.7em;
            text-align: center;

            background-color: var(--accent-colour);
            border-radius: 10px;
        }

        .a1-box {
            grid-column: 1/3;
            grid-row: 2/3;
        }

        .a2-box {
            grid-column: 3/5;
            grid-row: 2/3;
        }

        .a3-box {
            grid-column: 1/3;
            grid-row: 3/4;
        }

        .a4-box {
            grid-column: 3/5;
            grid-row: 3/4;
        }

        .question-span {
            justify-self: center;
            align-self: center;
        }

        /* Question number CSS */
        #question-numbers-wrapper {
            grid-column: 1/5;
            align-self: end;
        }

        .question-number {
            display: grid;
            
            float: left;
            height: 40px;
            width: 40px;
            margin: 0.7em;
            border-radius: 100px;
            background-color: var(--accent-colour);
            color: var(--primary-text)
        }

        .question-number:hover, .question-box:hover {
            background-color: var(--primary-hover);
        }

        .question-nav-span {
            justify-self: center;
            align-self: center;
        }

        .question-header, .question-paragraph, .question-box {
            display: none;
        }
    </style>
{% endblock %}

{% block scripts %}
    {{ block.super }}
    <script id="quiz-js">
        function select_question(question_number) {
            // ensure that all question related elements are hidden before displaying another
            // have to use querySelectorAll to select multiple classes
            question_elements = document.querySelectorAll(".question-header,.question-paragraph,.question-box");
            
            // set all display modes to none
            for (i = 0; i < question_elements.length; i++) {
                question_elements[i].style.display = "none";
            }

            // get global CSS variables for relevant colours
            default_colour = getComputedStyle(document.documentElement).getPropertyValue("--accent-colour");
            hover_colour = getComputedStyle(document.documentElement).getPropertyValue("--primary-hover");

            question_numbers = document.getElementsByClassName("question-number")
            for (i = 0; i < question_numbers.length; i++) {
                // set all question number divs to have default colour
                question_numbers[i].style.backgroundColor = default_colour;
            }

            // collect all elements relating to a single question, and display them with according properties
            single_question_elements = document.getElementsByClassName("q" + question_number)
            for (i = 0; i < single_question_elements.length; i++) {
                if (single_question_elements[i].constructor.name == "HTMLDivElement") {
                    single_question_elements[i].style.display = "grid";
                } else {
                    single_question_elements[i].style.display = "block";
                }
            }
            
            // darken the selected question
            document.getElementById("q" + question_number + "-nav").style.backgroundColor = hover_colour;
        
        }

        select_question(1);
    </script>
{% endblock %}

{% block content %}
    <div id="context">
        {% for question in question_data %}
            <h1 class="question-header q{{ forloop.counter }}">Question {{ forloop.counter }} (Spec: {{ question.spec_point }})</h1>
            <p class="question-paragraph q{{ forloop.counter }}">
                {{ question.question }}
            </p>
        {% endfor %}
    </div>

    {% for question in question_data %}
        <div class="question-box a1-box q{{ forloop.counter }}"><span class="question-span">{{ question.a }}</span></div>
        <div class="question-box a2-box q{{ forloop.counter }}"><span class="question-span">{{ question.b }}</span></div>
        <div class="question-box a3-box q{{ forloop.counter }}"><span class="question-span">{{ question.c }}</span></div>
        <div class="question-box a4-box q{{ forloop.counter }}"><span class="question-span">{{ question.d }}</span></div>
    {% endfor %}


    <div id="question-numbers-wrapper">
        {% for question in question_data %}
            <div class="question-number" id="q{{ forloop.counter }}-nav" onclick="select_question({{ forloop.counter }})"><span class="question-nav-span">{{ forloop.counter }}</span></div>
        {% endfor %}
    </div>

{% endblock content %}